# Movie Management System

Это проект для управления коллекцией фильмов, который позволяет добавлять, редактировать, удалять фильмы, а также отображать их на главной странице. Система использует MySQL для хранения данных о фильмах и Redis для отслеживания количества просмотров каждого фильма.

## Функциональные возможности

- **Добавление фильмов**: возможность добавить новый фильм в систему.
- **Редактирование фильмов**: возможность редактировать информацию о фильме.
- **Удаление фильмов**: возможность удалить фильм из системы.
- **Просмотр фильма**: каждый фильм отображается с подробной информацией, включая количество просмотров.
- **Подсчет просмотров с Redis**: использование Redis для отслеживания количества просмотров фильмов.

## Структура проекта

- `db.php` - файл для подключения к базе данных MySQL.
- `index.php` - главная страница, отображающая все фильмы.
- `add.php` - страница для добавления нового фильма.
- `edit.php` - страница для редактирования информации о фильме.
- `delete.php` - страница для удаления фильма.
- `details.php` - страница с подробной информацией о фильме.
- `redis.php` - файл для работы с Redis.

## Установка

1. Склонируйте репозиторий на ваш локальный компьютер:

   ```bash
   git clone <ссылка на репозиторий>
   ```

## Установите зависимости (если есть) для Redis:

Установите Redis на вашу машину.

Установите Predis (клиент для Redis):

```
composer require predis/predis
```

## Настройте базу данных MySQL:

Создайте базу данных movies_db и таблицу movies:

```
CREATE DATABASE movies_db;
USE movies_db;

CREATE TABLE movies (
    id INT AUTO_INCREMENT PRIMARY KEY,
    title VARCHAR(255) NOT NULL,
    year INT NOT NULL,
    genre VARCHAR(255),
    director VARCHAR(255),
    description TEXT,
    poster VARCHAR(255)
);

```

## Настройте подключение к базе данных в файле db.php, указав свои параметры для подключения.

Запустите веб-сервер и откройте приложение в браузере

## Ключевые фрагменты кода

1. Подключение к базе данных (db.php)

```
<?php
// db.php - Файл для подключения к MySQL базе данных
$host = 'localhost'; // Хост базы данных
$dbname = 'movies_db'; // Название базы данных
$username = 'root'; // Имя пользователя
$password = ''; // Пароль

try {
    $pdo = new PDO("mysql:host=$host;dbname=$dbname", $username, $password);
    // Устанавливаем режим ошибок
    $pdo->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
} catch (PDOException $e) {
    die("Ошибка подключения: " . $e->getMessage());
}
?>
```

## 2. Добавление фильма в базу данных (add.php)

```
<?php
// add.php - Страница для добавления нового фильма
require_once 'db.php';

if ($_SERVER['REQUEST_METHOD'] === 'POST') {
    $title = $_POST['title'];
    $year = $_POST['year'];
    $genre = $_POST['genre'];
    $director = $_POST['director'];
    $description = $_POST['description'];
    $poster = $_POST['poster']; // Путь к изображению постера

    $stmt = $pdo->prepare("INSERT INTO movies (title, year, genre, director, description, poster)
                           VALUES (:title, :year, :genre, :director, :description, :poster)");
    $stmt->execute(['title' => $title, 'year' => $year, 'genre' => $genre, 'director' => $director, 'description' => $description, 'poster' => $poster]);

    echo "Фильм добавлен!";
}
?>

<form action="add.php" method="POST">
    <input type="text" name="title" placeholder="Название фильма" required>
    <input type="number" name="year" placeholder="Год выпуска" required>
    <input type="text" name="genre" placeholder="Жанр" required>
    <input type="text" name="director" placeholder="Режиссер" required>
    <textarea name="description" placeholder="Описание" required></textarea>
    <input type="text" name="poster" placeholder="Ссылка на постер">
    <button type="submit">Добавить фильм</button>
</form>

```

## 3. Удаление фильма (delete.php)

```
<?php
// delete.php - Страница удаления фильма
require_once 'db.php';

if ($_SERVER['REQUEST_METHOD'] === 'POST') {
    $id = $_POST['id'];

    $stmt = $pdo->prepare("DELETE FROM movies WHERE id = :id");
    $stmt->execute(['id' => $id]);

    echo "Фильм удален!";
}

$id = $_GET['id'];
?>

<form action="delete.php" method="POST">
    <input type="hidden" name="id" value="<?= $id ?>">
    <p>Вы уверены, что хотите удалить этот фильм?</p>
    <button type="submit">Удалить</button>
</form>

```

## Главная страница для отображения всех фильмов (index.php)

```
<?php
// index.php - Главная страница, вывод всех фильмов
require_once 'db.php';

$stmt = $pdo->query("SELECT * FROM movies");
$movies = $stmt->fetchAll();

foreach ($movies as $movie) {
    echo "<div>";
    echo "<h2>" . htmlspecialchars($movie['title']) . "</h2>";
    echo "<p>" . htmlspecialchars($movie['genre']) . " | " . $movie['year'] . "</p>";
    echo "<p>" . htmlspecialchars($movie['description']) . "</p>";
    echo "<img src='" . htmlspecialchars($movie['poster']) . "' alt='poster'>";
    echo "<a href='details.php?id=" . $movie['id'] . "'>Подробнее</a>";
    echo "</div>";
}
?>

```

## 1. Какие преимущества даёт использование единой точки входа в веб-приложении?

Единая точка входа в веб-приложении, как правило, реализуется через файл, который обрабатывает все запросы (например, index.php или app.js). Преимущества использования единой точки входа:

Упрощение маршрутизации: Все запросы идут через один файл, что упрощает управление маршрутизацией и обработку URL.

Централизованная обработка ошибок: Легче реализовать обработку ошибок и логирование, поскольку весь трафик проходит через один файл.

Повторное использование кода: Общие функции, такие как авторизация или проверка сессий, можно реализовать в одном месте и использовать в разных частях приложения.

Безопасность: Возможность централизованного контроля доступа и защиты данных.

## 2. Какие преимущества даёт использование шаблонов?

Использование шаблонов в веб-разработке приносит следующие преимущества:

Разделение логики и представления: Логика приложения отделяется от представления, что облегчает поддержку и развитие приложения.

Повторное использование кода: Шаблоны позволяют многократно использовать одни и те же элементы интерфейса (например, шапку сайта, меню), уменьшая дублирование кода.

Упрощение изменений дизайна: Если необходимо изменить внешний вид, это можно сделать в одном месте (шаблоне), и изменения сразу отобразятся на всех страницах.

Легче тестировать и поддерживать: Шаблонные системы предоставляют возможность лучше структурировать код, что упрощает его тестирование и поддержку.

## 3. Какие преимущества даёт хранение данных в базе по сравнению с хранением в файлах?

Хранение данных в базе данных имеет несколько ключевых преимуществ по сравнению с хранением в файлах:

Производительность: Базы данных оптимизированы для быстрого поиска и обработки больших объемов данных, в то время как файлы могут стать медленными и неудобными при увеличении объема.

Масштабируемость: Базы данных легко масштабируются, поддерживают индексы и другие механизмы для повышения производительности на больших объемах данных.

Безопасность: Базы данных обеспечивают доступ на уровне пользователей и могут поддерживать механизмы резервного копирования и восстановления, чего не всегда легко достичь с файлами.

Консистентность: Базы данных обеспечивают атомарность и транзакции, что гарантирует целостность данных. В случае с файлами часто бывает сложнее контролировать их целостность.

Управление данными: Базы данных предлагают удобные инструменты для запросов и манипуляций с данными, в отличие от работы с файлами, где требуется ручная обработка.

## 4. Что такое SQL-инъекция? Придумайте пример SQL-инъекции и объясните, как её предотвратить.

SQL-инъекция — это уязвимость в веб-приложении, которая позволяет злоумышленнику вставлять (инъецировать) вредоносные SQL-запросы в приложение через пользовательский ввод, что может привести к несанкционированному доступу к базе данных, утечке данных или повреждению базы данных.
